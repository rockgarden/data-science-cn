# AI分析

根据您提供的《GB/T 36344-2018 信息技术 数据质量评价指标》国家标准，我们可以将该 `sys_api` 表的结构与标准中定义的六大类数据质量评价指标（规范性、完整性、准确性、一致性、时效性、可访问性）进行对标，推测其在各维度上可能需要关注和评价的指标。

以下是基于该标准对 `sys_api` 表进行的数据质量维度分析：

---

## **1. 规范性 (Conformity)**

**定义**：数据符合数据标准、数据模型、业务规则、元数据或权威参考数据的程度。

对于 `sys_api` 表，规范性主要体现在字段的定义、格式和取值是否遵循了预设的规则和标准。

* **指标编号 0101: 数据标准**
  * **指标描述**：检查 `sys_api` 表中的数据是否符合预先定义的数据标准。
  * **推测应用**：
    * 字段命名规范：`app_id`、`create_by` 等是否符合项目或公司的命名约定（如全小写、下划线分隔）。
    * `method` 字段的取值是否限定为标准的 HTTP 方法（如 `GET`, `POST`, `PUT`, `DELETE`），而非随意填写。
    * `response_data_type` 是否符合预定义的类型列表（如 `JSON`, `XML`, `TEXT`）。
    * `register_type` 是否仅允许 `权限`, `网关自动注册`, `手动添加` 这三种值。
  * **计算方法**：符合标准的记录数 / 总记录数。

* **指标编号 0102: 数据模型**
  * **指标描述**：数据是否符合数据库的设计模型。
  * **推测应用**：
    * 检查表结构本身是否与ER图或设计文档一致（如主键、外键、索引 `idx_app_id` 的存在）。
    * `app_id` 字段作为外键，其值是否存在于 `sys_app`（或类似）的应用表中。
  * **计算方法**：符合数据模型约束的记录数 / 总记录数。

* **指标编号 0103: 元数据**
  * **指标描述**：数据是否符合其元数据的定义。
  * **推测应用**：
    * 该表的元数据（如数据字典）中定义 `encrypt` 字段为 `bit(1)`，实际存储的值是否仅为 `0` 或 `1`，而没有其他非法值。
    * `version` 字段在元数据中定义为 `varchar(255)`，其实际值是否符合版本号格式（如 `v1.0.0`）。
  * **计算方法**：符合元数据定义的记录数 / 总记录数。

* **指标编号 0104: 业务规则**
  * **指标描述**：数据是否符合业务层面的规则。
  * **推测应用**：
    * 业务规则可能规定：当 `type` 为 `内部API` 时，`enabled` 必须为 `1`（启用）。
    * 当 `register_type` 为 `网关自动注册` 时，`create_by` 字段应为系统用户（如 `gateway`），而非普通员工。
  * **计算方法**：符合业务规则的记录数 / 总记录数。

* **指标编号 0105: 权威参考数据**
  * **指标描述**：数据是否引用了正确的参考值。
  * **推测应用**：
    * `method` 字段的值必须是权威的HTTP方法列表中的一个。
    * `openapi_type` 字段的值必须来自一个预定义的开放API类型列表。
  * **计算方法**：引用了权威参考数据的记录数 / 总记录数。

* **指标编号 0106: 安全规范**
  * **指标描述**：数据是否符合安全和隐私规则。
  * **推测应用**：
    * `api_secret` 和 `api_secret_private` 字段存储的秘钥是否经过加密处理，而非明文存储。
    * `is_delete` 为 `1` 的记录，其敏感信息（如 `api_secret`）是否已被脱敏或清除。
  * **计算方法**：符合安全规范的记录数 / 总记录数。

---

## **2. 完整性 (Completeness)**

**定义**：按照数据规则要求，数据元素被赋予数值的程度。

完整性关注的是“该填的是否都填了”。

* **指标编号 0201: 数据元素完整性**
  * **指标描述**：检查关键字段是否为空。
  * **推测应用**：
    * `name` (API名称)、`path` (API路径)、`method` (请求方式)、`app_id` (应用ID) 这些核心字段是否都已赋值，不允许为空。
  * **计算方法**：关键字段均不为空的记录数 / 总记录数。

* **指标编号 0202: 数据记录完整性**
  * **指标描述**：从更高层次看，一条完整的API记录应包含哪些必要信息。
  * **推测应用**：
    * 对于一个“已启用”（`enabled=1`）的API，其 `request_params_example` (请求参数示例) 和 `response_data_example` (返回值示例) 是否也应要求填写，以保证开发文档的完整性。
  * **计算方法**：满足完整记录要求的记录数 / 总记录数。

---

## **3. 准确性 (Accuracy)**

**定义**：数据准确表示其所描述的真实实体真实值的程度。

准确性关注的是“填的对不对”。

* **指标编号 0301: 数据内容正确性**
  * **指标描述**：数据内容是否真实、正确。
  * **推测应用**：
    * `path` 字段记录的API路径是否与实际部署在网关或服务中的路径完全一致。
    * `response_data` 字段描述的返回结构是否与API实际返回的JSON结构匹配。
  * **计算方法**：内容正确的记录数 / 总记录数。

* **指标编号 0302: 数据格式合规性**
  * **指标描述**：数据的格式是否符合预期。
  * **推测应用**：
    * `create_time` 和 `update_time` 字段的值是否为有效的日期时间格式（如 `YYYY-MM-DD HH:MM:SS`）。
    * `app_id` 是否为有效的数字，而非字母或特殊字符。
  * **计算方法**：格式合规的记录数 / 总记录数。

* **指标编号 0303: 数据重复率**
  * **指标描述**：意外重复的度量。
  * **推测应用**：
    * 是否存在两条记录，其 `app_id` + `path` + `method` 的组合完全相同，这通常意味着API定义重复。
  * **计算方法**：重复记录数 / 总记录数。

* **指标编号 0304: 数据唯一性**
  * **指标描述**：特定字段或组合的唯一性。
  * **推测应用**：
    * `id` 字段作为主键，必须唯一。
    * 业务上可能要求 `path` + `method` 的组合在全局或某个应用内是唯一的。
  * **计算方法**：满足唯一性要求的记录数 / 总记录数。

* **指标编号 0305: 脏数据出现率**
  * **指标描述**：无效数据的度量。
  * **推测应用**：
    * `response_code` 字段中是否包含非标准的HTTP状态码（如 `999`），或者格式混乱的文本。
    * `content` 字段中是否包含乱码或无法解析的字符。
  * **计算方法**：包含脏数据的记录数 / 总记录数。

---

## **4. 一致性 (Consistency)**

**定义**：数据与其他特定上下文中使用的数据无矛盾的程度。

* **指标编号 0401: 相同数据一致性**
  * **指标描述**：同一数据在不同位置的一致性。
  * **推测应用**：
    * `sys_api` 表中记录的 `app_id`，是否与 `sys_app` 表中对应应用的ID和名称保持一致。
    * 当 `sys_app` 表中某个应用的名称被修改后，`sys_api` 表中关联的API记录是否也应同步更新其所属应用的显示名称（如果存在冗余字段）。
  * **计算方法**：在不同上下文中保持一致的记录数 / 总记录数。

* **指标编号 0402: 关联数据一致性**
  * **指标描述**：根据规则检查关联数据的一致性。
  * **推测应用**：
    * 如果 `enabled` 字段为 `0`（禁用），那么 `flow_control_rule` (流控规则) 和 `degrade_rule` (降级规则) 是否也应该被置空或标记为无效，以避免规则冲突。
  * **计算方法**：满足关联一致性约束的记录数 / 总记录数。

---

## **5. 时效性 (Timeliness)**

**定义**：数据在时间变化中的正确程度。

* **指标编号 0501: 基于时间段的正确性**
  * **推测应用**：此指标在 `sys_api` 表中不太直接适用，除非有字段记录API的有效期。

* **指标编号 0502: 基于时间点及时性**
  * **指标描述**：数据更新的及时性。
  * **推测应用**：
    * 当API的实际配置在网关上发生变更后，`sys_api` 表中的 `update_time` 是否在合理的时间窗口内（如5分钟内）被更新。
  * **计算方法**：在规定时间内更新的记录数 / 应更新的记录总数。

* **指标编号 0503: 时序性**
  * **指标描述**：数据元素间的相对时序关系。
  * **推测应用**：
    * `create_time` 是否早于或等于 `update_time`。
    * 如果 `is_delete` 为 `1`，则 `delete_time` 必须晚于 `update_time`。
  * **计算方法**：满足时序关系的记录数 / 总记录数。

---

## **6. 可访问性 (Accessibility)**

**定义**：数据能被访问的程度。

* **指标编号 0601: 可访问**
  * **指标描述**：数据在需要时的可获取性。
  * **推测应用**：
    * 当API管理平台需要查询某个API详情时，能否成功从 `sys_api` 表中读取到该记录（无数据库连接超时、无权限拒绝）。
  * **计算方法**：可成功访问的记录数 / 请求访问的记录总数。

* **指标编号 0602: 可用性**
  * **指标描述**：数据在设定有效生存周期内的可使用性。
  * **推测应用**：
    * 标记为 `is_delete=1` 的记录，在经过一定周期（如6个月）的归档期后，是否已从主库移除，但仍可在归档库中查询到，以满足审计要求。
  * **计算方法**：在有效生存周期内可使用的记录数 / 应可用的记录总数。

---

## **总结**

通过对 `sys_api` 表应用GB/T 36344-2018标准，我们可以系统地从六个维度构建数据质量评价体系。这不仅有助于发现当前数据中的问题（如缺失、错误、重复），更能建立持续监控和改进的机制，确保API元数据的高质量，从而支撑整个API管理生态的稳定和高效运行。
